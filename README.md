### Info

This directory contains a derivative of project [swtestacademy/VisualAutomationImageMagickSelenium](https://github.com/swtestacademy/VisualAutomationImageMagickSelenium).

Note: on Window, you can install either static or dynamically linked application
from [https://www.imagemagick.org/script/download.php](https://www.imagemagick.org/script/download.php), make sure you will need to
copy the `magic.exe` to `convert.exe` and `compare.exe` after installation and use the installer -
avoid file copy install: on Windows the Image Magick uses Windows Registry to find its own location.
The registry path to scan is in the `src/test/resources/application.properties`:
```java
imagemagickRegistryPath: SOFTWARE\\ImageMagick\\7.0.8\\Q:16
```
The error
```java
org.im4java.core.CommandException: org.im4java.core.CommandException: convert.exe: RegistryKeyLookupFailed `CoderModulesPath' @error/module.c/GetMagickModulePath/657.
```
is a manifestation of a manually installed Image Magic.

To demo the project, run
```cmd
mvn clean test
```
followed by
```cmd
mvn test
```
with a little delay between the runs.
You will find the baseline screenshot of page element, actual screenshot and a visual diff
in the `screenshots` folder of the project in a subfolder named after the test method e.g. `imageCompareTest`.

In the clean run, the baseline screenshot of some example page element is created
and saved as a new baseline but the image diff is neither computed nor saved: the original project logic has left unmodified in this regards.

The program also generates the standalone comparison script in the project directory
The default filename is `myscript.cmd` for Windows:
```cmd
@echo off
REM -------------------------------------------------------
REM  Cmd-script autogenerated by im4java
REM -------------------------------------------------------

set PATH=C:\Program Files\ImageMagick-7.0.6-Q16;C:\Program Files\ImageMagick-7.0.6-Q16;%PATH%

compare ^
   -fuzz "5.0" ^
  -metric "AE" "ScreenShots\imageCompareTest\imageCompareTest_Baseline.png" "ScreenShots\imageCompareTest\imageCompareTest_Actual.png" "ScreenShots\imageCompareTest\imageCompareTest_Diff.png"
```
and `myscript` for Unix:
```sh
#!/bin/bash
#-------------------------------------------------------
# Bash-script autogenerated by im4java
#-------------------------------------------------------

compare \
   -fuzz "5.0" \
  -metric "AE" "screenshots/imageCompareTest/imageCompareTest_Baseline.png" "screenshots/imageCompareTest/imageCompareTest_Actual.png" "screenshots/imageCompareTest/imageCompareTest_Diff.png"
```

In addition the project can resize the screen shots with the help of Image Magick.
The cleanup script `cleanup.cmd` is provided.

### See Also

  * http://www.programcreek.com/java-api-examples/index.php?api=org.im4java.core.ConvertCmd
  * [Widen/im4java](https://github.com/Widen/im4java) is a pure-java interface to the ImageMagick commandline.
  * [im4java guide](http://im4java.sourceforge.net/docs/dev-guide.html)
  * [im4java util](https://github.com/hailin0/im4java-util)
  * [jmagick](https://github.com/techblue/jmagick)
  * imagemagick [usage](http://www.imagemagick.org/Usage/)
  * java code examples of [ConvertCmd](https://www.programcreek.com/java-api-examples/?api=org.im4java.core.ConvertCmd) API
  * java code examples of [IMOperation](https://www.programcreek.com/java-api-examples/index.php?api=org.im4java.core.IMOperation) class
  * convertcmd option details for [background cleanup](https://snippets.aktagon.com/snippets/558-how-to-remove-a-background-with-imagemagick)
  * http://codoid.com/automation-testing-comparing-screenshots/
  * [ocular](https://github.com/vinsguru/ocular)
  * [kreyssel/selenium2-visualdiff](https://github.com/kreyssel/selenium2-visualdiff) using `javax.imageio.ImageIO` and `java.awt.image.BufferedImage`
  * [jsoup cookbook introduction](https://jsoup.org/cookbook/introduction/parsing-a-document)
  * java [library](https://github.com/romankh3/image-comparison) that compares 2 images with the same sizes pixel by pexel and draws rectangles around the image differences visually, also available in [maven central](https://search.maven.org/artifact/com.github.romankh3/image-comparison/3.1.1/jar)

### Author
[Serguei Kouzmine](kouzmine_serguei@yahoo.com)

