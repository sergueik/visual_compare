### Info

This directory contains a derivative of project [swtestacademy/VisualAutomationImageMagickSelenium](https://github.com/swtestacademy/VisualAutomationImageMagickSelenium).

Note: on Window, you can install either static or dynamically linked application
[ImageMagick-7.0.6-3-Q16-x64-static.exe](https://www.imagemagick.org/script/download.php), make sure you will need to
copy the `magic.exe` to `convert.exe` and `compare.exe` after installation and run the installer -
avoid file copy install: on Windows the Image Magick uses Windows Registry to find its own location.
The error
```java
org.im4java.core.CommandException: org.im4java.core.CommandException:
convert.exe: RegistryKeyLookupFailed `CoderModulesPath' @error/module.c/GetMagickModulePath/657.
...
```
is a manifestation of a manually installed Image Magic.

To demo the project run
```cmd
mvn clean test
```
followed by
```cmd
mvn test
```
with a little delay between the runs.
You will find the baseline screenshot of page element, actual screenshot and a visual diff
in the `screenshots` folder of the project in a subfolder named after the test method e.g. `imageCompareTest`.

After the intial clean run, the baseline screenshot of some example element of the pasge is created snd saved as a new baseline but not the image diff is not ecomputed nor saved: the original project logic has left unmodified in this regards.

The program also saves the standalone comparison script into the file `myscript.cmd` (`myscript` on Unix)
in the following format:

```cmd
@echo off
REM -------------------------------------------------------
REM  Cmd-script autogenerated by im4java
REM -------------------------------------------------------

set PATH=C:\Program Files\ImageMagick-7.0.6-Q16;C:\Program Files\ImageMagick-7.0.6-Q16;%PATH%

compare ^
   -fuzz "5.0" ^
  -metric "AE" "ScreenShots\imageCompareTest\imageCompareTest_Baseline.png" "ScreenShots\imageCompareTest\imageCompareTest_Actual.png" "ScreenShots\imageCompareTest\imageCompareTest_Diff.png"
```
or, on Linux box,
```sh
#!/bin/bash
#-------------------------------------------------------
# Bash-script autogenerated by im4java
# at Fri Jul 13 19:02:56 EDT 2018
#-------------------------------------------------------

compare \
   -fuzz "5.0" \
  -metric "AE" "screenshots/imageCompareTest/imageCompareTest_Baseline.png" "screenshots/imageCompareTest/imageCompareTest_Actual.png" "screenshots/imageCompareTest/imageCompareTest_Diff.png"
```

In addition the project can resize the screen shots with the help of Image Magick.


### TODO:
With recent versions of Selenium jars in the `pom.xml` one has the following runtine errors:

__3.8.1__:
```
java.lang.NoSuchMethodError: com.google.common.util.concurrent.SimpleTimeLimiter.create(Ljava/util/concurrent/ExecutorService;)Lcom/google/common/util/concurrent/SimpleTimeLimiter;
        at org.utils.VisualTest.setupTestClass(VisualTest.java:87)
```
__3.4.0__:
```
java.lang.NoSuchMethodError: com.sun.jna.platform.win32.WinNT$PSID.createFieldsOrder(Ljava/lang/String;)Ljava/util/List;
```
Therefore the version of Selenium driver jar in the `pom.xml` should not be newer than __3.3.1__.

### See Also

  * http://www.programcreek.com/java-api-examples/index.php?api=org.im4java.core.ConvertCmd
  * [im3java guide](http://im4java.sourceforge.net/docs/dev-guide.html)
  * http://codoid.com/automation-testing-comparing-screenshots/
  * [ocular](https://github.com/vinsguru/ocular)

### Author
[Serguei Kouzmine](kouzmine_serguei@yahoo.com)

